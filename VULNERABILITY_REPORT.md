# GÃ¼venlik AÃ§Ä±ÄŸÄ± DeÄŸerlendirme Raporu

**Proje:** Mini Web UygulamasÄ± GÃ¼venlik AÃ§Ä±ÄŸÄ± Projesi  
**AÃ§Ä±k TÃ¼rÃ¼:** SQL Injection (SQLi)  
**Ã–nem Derecesi:** Kritik  
**Tarih:** 2025  
**Yazar:** Ege Koca

---

## Ã–zet

Bu rapor, Flask tabanlÄ± bir web uygulamasÄ±ndaki SQL Injection gÃ¼venlik aÃ§Ä±ÄŸÄ±nÄ±n tespit edilmesi, exploit edilmesi ve dÃ¼zeltilmesi sÃ¼recini belgelemektedir. Bu aÃ§Ä±k, geÃ§erli kimlik bilgileri olmadan yetkisiz kullanÄ±cÄ± eriÅŸimine izin vermektedir.

## 1. Uygulama Genel BakÄ±ÅŸÄ±

### 1.1 Uygulama AÃ§Ä±klamasÄ±
KullanÄ±cÄ± kimlik doÄŸrulama sistemi uygulayan basit bir Flask web uygulamasÄ±dÄ±r. Uygulama, kullanÄ±cÄ±larÄ±n bir kullanÄ±cÄ± adÄ± saÄŸlayarak giriÅŸ yapmasÄ±na olanak tanÄ±r ve bu bilgi SQLite veritabanÄ±nda sorgulanÄ±r.

### 1.2 Teknoloji YÄ±ÄŸÄ±nÄ±
- **Framework:** Flask 3.0.0
- **VeritabanÄ±:** SQLite3
- **Dil:** Python 3.9+
- **Ortam:** Localhost (127.0.0.1:5000)

### 1.3 Uygulama YapÄ±sÄ±
```
SecurityProje/
â”œâ”€â”€ app.py              # GÃ¼vensiz versiyon
â”œâ”€â”€ app_secure.py       # DÃ¼zeltilmiÅŸ versiyon
â”œâ”€â”€ templates/          # HTML ÅŸablonlarÄ±
â””â”€â”€ users.db           # SQLite veritabanÄ±
```

## 2. GÃ¼venlik AÃ§Ä±ÄŸÄ±nÄ±n Tespiti

### 2.1 AÃ§Ä±k TÃ¼rÃ¼
**SQL Injection (SQLi)** - OWASP Top 10 (2021) - A03:2021 â€“ Injection

### 2.2 AÃ§Ä±ÄŸÄ±n Konumu
**Dosya:** `app.py`  
**Fonksiyon:** `login()`  
**SatÄ±r:** 67

### 2.3 GÃ¼vensiz Kod
```python
# GÃœVENSÄ°Z KOD
username = request.form.get('username', '').strip()
query = f"SELECT * FROM users WHERE username = '{username}'"
cursor.execute(query)
```

### 2.4 KÃ¶k Neden Analizi

AÃ§Ä±k, kullanÄ±cÄ± girdisinin string interpolation kullanÄ±larak doÄŸrudan SQL sorgularÄ±na birleÅŸtirilmesinden kaynaklanmaktadÄ±r. Uygulama, kullanÄ±cÄ± girdisini veritabanÄ± sorgularÄ±na dahil etmeden Ã¶nce doÄŸrulamaz veya temizlemez.

**Neden tehlikeli:**
1. KullanÄ±cÄ± girdisi Ã§alÄ±ÅŸtÄ±rÄ±labilir SQL kodu olarak iÅŸleniyor
2. Girdi doÄŸrulama veya temizleme yok
3. Parametreli sorgular kullanÄ±lmÄ±yor
4. DoÄŸrudan string formatlama SQL komut enjeksiyonuna izin veriyor

## 3. GÃ¼venlik AÃ§Ä±ÄŸÄ±nÄ±n Exploit Edilmesi

### 3.1 SaldÄ±rÄ± VektÃ¶rÃ¼
SaldÄ±rgan, kullanÄ±cÄ± adÄ± giriÅŸ alanÄ± Ã¼zerinden kÃ¶tÃ¼ amaÃ§lÄ± SQL kodu enjekte edebilir ve bu kod sanitizasyon olmadan doÄŸrudan SQL sorgusuna eklenir.

### 3.2 Proof of Concept (PoC)

#### AdÄ±m 1: Normal GiriÅŸ Denemesi
**Girdi:** `admin`  
**OluÅŸturulan Sorgu:**
```sql
SELECT * FROM users WHERE username = 'admin'
```
**SonuÃ§:** BaÅŸarÄ±lÄ± giriÅŸ (kullanÄ±cÄ± varsa)

#### AdÄ±m 2: SQL Injection SaldÄ±rÄ±sÄ±
**Girdi:** `' OR '1'='1`  
**OluÅŸturulan Sorgu:**
```sql
SELECT * FROM users WHERE username = '' OR '1'='1'
```

**SaldÄ±rÄ± AÃ§Ä±klamasÄ±:**
- Tek tÄ±rnak (`'`) orijinal string'i kapatÄ±r
- `OR '1'='1'` SQL'de her zaman TRUE'dur
- Bu, tÃ¼m WHERE clause'unun TRUE olarak deÄŸerlendirilmesine neden olur
- VeritabanÄ± ilk kullanÄ±cÄ±yÄ± (genellikle admin) dÃ¶ndÃ¼rÃ¼r

**SonuÃ§:** GeÃ§erli kimlik bilgileri olmadan yetkisiz eriÅŸim saÄŸlandÄ±

### 3.3 Ek Exploit Payload'larÄ±

1. **Temel Bypass:**
   ```
   ' OR '1'='1
   ```

2. **Yorum tabanlÄ±:**
   ```
   admin' --
   ' OR '1'='1' --
   ```

3. **Union tabanlÄ± (uygulanabilirse):**
   ```
   ' UNION SELECT * FROM users --
   ```

### 3.4 Etki DeÄŸerlendirmesi

**Gizlilik:** âš ï¸ YÃœKSEK - KullanÄ±cÄ± hesaplarÄ±na yetkisiz eriÅŸim  
**BÃ¼tÃ¼nlÃ¼k:** âš ï¸ ORTA - Veri manipÃ¼lasyonu potansiyeli  
**EriÅŸilebilirlik:** âœ… DÃœÅÃœK - Hizmet eriÅŸilebilirliÄŸini etkilemez  
**Genel Ã–nem Derecesi:** ğŸ”´ **KRÄ°TÄ°K**

### 3.5 Etkilenen Ä°ÅŸlevsellik
- KullanÄ±cÄ± kimlik doÄŸrulama bypass'Ä±
- Herhangi bir kullanÄ±cÄ± hesabÄ±na yetkisiz eriÅŸim
- AyrÄ±calÄ±k yÃ¼kseltme potansiyeli
- VeritabanÄ± bilgi ifÅŸasÄ±

## 4. DÃ¼zeltme

### 4.1 Ã‡Ã¶zÃ¼m: Parametreli Sorgular

AÃ§Ä±k, SQL kodunu kullanÄ±cÄ± verisinden ayÄ±ran **parametreli sorgular** (prepared statements olarak da bilinir) kullanÄ±larak dÃ¼zeltilmiÅŸtir.

### 4.2 DÃ¼zeltilmiÅŸ Kod
**Dosya:** `app_secure.py`  
**Fonksiyon:** `login()`  
**SatÄ±rlar:** 67-68

```python
# GÃœVENLÄ° KOD
username = request.form.get('username', '').strip()
query = "SELECT * FROM users WHERE username = ?"
cursor.execute(query, (username,))
```

### 4.3 DÃ¼zeltmenin NasÄ±l Ã‡alÄ±ÅŸtÄ±ÄŸÄ±

1. **Sorgu Åablonu:** SQL sorgu yapÄ±sÄ± ayrÄ± olarak tanÄ±mlanÄ±r
2. **Parametre Yer Tutucusu:** `?` kullanÄ±cÄ± girdisinin nereye ekleneceÄŸini iÅŸaretler
3. **GÃ¼venli Ã‡alÄ±ÅŸtÄ±rma:** KullanÄ±cÄ± girdisi sorgu string'inin bir parÃ§asÄ± olarak deÄŸil, parametre olarak geÃ§irilir
4. **Otomatik KaÃ§Ä±ÅŸ:** VeritabanÄ± sÃ¼rÃ¼cÃ¼sÃ¼ Ã¶zel karakterleri otomatik olarak escape eder

### 4.4 GÃ¼venlik Ä°yileÅŸtirmeleri

âœ… Girdi veri olarak iÅŸlenir, Ã§alÄ±ÅŸtÄ±rÄ±labilir kod olarak deÄŸil  
âœ… SQL injection denemeleri etkisiz hale getirilir  
âœ… Ã–zel karakterler otomatik olarak escape edilir  
âœ… Sorgu yapÄ±sÄ± kullanÄ±cÄ± girdisi tarafÄ±ndan deÄŸiÅŸtirilemez  

## 5. DoÄŸrulama

### 5.1 DÃ¼zeltmenin Test Edilmesi

**Test Durumu 1: Normal GiriÅŸ**
- **Girdi:** `admin`
- **SonuÃ§:** âœ… BaÅŸarÄ±lÄ± giriÅŸ (beklenen davranÄ±ÅŸ korundu)

**Test Durumu 2: SQL Injection Denemesi**
- **Girdi:** `' OR '1'='1`
- **SonuÃ§:** âŒ GiriÅŸ baÅŸarÄ±sÄ±z (enjeksiyon engellendi)
- **Ã‡alÄ±ÅŸtÄ±rÄ±lan Sorgu:** `SELECT * FROM users WHERE username = '? OR ?1?=?1'` (literal string olarak iÅŸlendi)

**Test Durumu 3: KÃ¶tÃ¼ AmaÃ§lÄ± Payload**
- **Girdi:** `admin' --`
- **SonuÃ§:** âŒ GiriÅŸ baÅŸarÄ±sÄ±z (enjeksiyon engellendi)

### 5.2 DoÄŸrulama SonuÃ§larÄ±

| Test Durumu | GÃ¼vensiz Versiyon | GÃ¼venli Versiyon |
|-------------|-------------------|------------------|
| Normal giriÅŸ | âœ… Ã‡alÄ±ÅŸÄ±yor | âœ… Ã‡alÄ±ÅŸÄ±yor |
| SQL Injection | âŒ Exploit edilebilir | âœ… Engellendi |
| Ã–zel karakterler | âŒ GÃ¼vensiz | âœ… GÃ¼venli |

## 6. En Ä°yi Uygulama Ã–nerileri

1. **VeritabanÄ± iÅŸlemleri iÃ§in her zaman parametreli sorgular kullanÄ±n**
2. **Uygulama sÄ±nÄ±rlarÄ±nda girdi doÄŸrulama uygulayÄ±n**
3. **VeritabanÄ± kullanÄ±cÄ±larÄ±na en az ayrÄ±calÄ±k prensibini uygulayÄ±n**
4. **DÃ¼zenli gÃ¼venlik denetimleri ve penetrasyon testleri yapÄ±n**
5. **BaÄŸÄ±mlÄ±lÄ±klarÄ± en son gÃ¼venli sÃ¼rÃ¼mlere gÃ¼ncelleyin**
6. **ÅÃ¼pheli aktiviteler iÃ§in loglama ve izleme uygulayÄ±n**

## 7. Referanslar

- [OWASP SQL Injection](https://owasp.org/www-community/attacks/SQL_Injection)
- [OWASP Top 10 (2021)](https://owasp.org/Top10/)
- [CWE-89: SQL Injection](https://cwe.mitre.org/data/definitions/89.html)
- [Flask Security Best Practices](https://flask.palletsprojects.com/en/latest/security/)

## 8. SonuÃ§

SQL Injection gÃ¼venlik aÃ§Ä±ÄŸÄ± baÅŸarÄ±yla tespit edildi, exploit edildi ve dÃ¼zeltildi. Parametreli sorgular kullanÄ±larak yapÄ±lan dÃ¼zeltme, uygulama iÅŸlevselliÄŸini korurken SQL injection saldÄ±rÄ±larÄ±nÄ± tamamen Ã¶nlemektedir. Bu, web uygulama geliÅŸtirmede gÃ¼venli kodlama uygulamalarÄ±nÄ±n kritik Ã¶nemini gÃ¶stermektedir.

---

**Rapor Durumu:** âœ… TamamlandÄ±  
**AÃ§Ä±k Durumu:** âœ… DÃ¼zeltildi  
**DoÄŸrulama Durumu:** âœ… DoÄŸrulandÄ±
